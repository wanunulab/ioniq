

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ionique.utils &mdash; ionique 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ionique.datatypes" href="datatypes.html" />
    <link rel="prev" title="ionique.parsers" href="parsers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ionique
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Nanopore Signal Analysis Framework</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="io.html">ionique.io</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html">ionique.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="parsers.html">ionique.parsers</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ionique.utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ionique.utils.Filter"><code class="docutils literal notranslate"><span class="pre">Filter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Filter.__init__"><code class="docutils literal notranslate"><span class="pre">Filter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Filter.bidirectional"><code class="docutils literal notranslate"><span class="pre">Filter.bidirectional</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Filter.cutoff_frequency"><code class="docutils literal notranslate"><span class="pre">Filter.cutoff_frequency</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Filter.filter_method"><code class="docutils literal notranslate"><span class="pre">Filter.filter_method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Filter.filter_type"><code class="docutils literal notranslate"><span class="pre">Filter.filter_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Filter.order"><code class="docutils literal notranslate"><span class="pre">Filter.order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Filter.sampling_frequency"><code class="docutils literal notranslate"><span class="pre">Filter.sampling_frequency</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ionique.utils.Singleton"><code class="docutils literal notranslate"><span class="pre">Singleton</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Singleton.__init__"><code class="docutils literal notranslate"><span class="pre">Singleton.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ionique.utils.Trimmer"><code class="docutils literal notranslate"><span class="pre">Trimmer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Trimmer.__init__"><code class="docutils literal notranslate"><span class="pre">Trimmer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Trimmer.newrank"><code class="docutils literal notranslate"><span class="pre">Trimmer.newrank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Trimmer.rank"><code class="docutils literal notranslate"><span class="pre">Trimmer.rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ionique.utils.Trimmer.samples_to_remove"><code class="docutils literal notranslate"><span class="pre">Trimmer.samples_to_remove</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ionique.utils.extract_features"><code class="docutils literal notranslate"><span class="pre">extract_features()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ionique.utils.si_eval"><code class="docutils literal notranslate"><span class="pre">si_eval()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ionique.utils.split_voltage_steps"><code class="docutils literal notranslate"><span class="pre">split_voltage_steps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="datatypes.html">ionique.datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="cparsers.html">ionique.cparsers</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install_beginner.html">Installation for beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ionique_starter.html">Install Ionique</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_vscode_start.html">Guide for VSCode and Python Installation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ionique</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api_reference.html">API Reference</a></li>
      <li class="breadcrumb-item active">ionique.utils</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ionique-utils">
<h1>ionique.utils<a class="headerlink" href="#ionique-utils" title="Link to this heading"></a></h1>
<p id="module-ionique.utils">Signal Processing and Data Extraction Utilities</p>
<p>This module provides a set of utility functions and classes designed for use in signal
processing workflows.</p>
<p>These tools are intended for both internal processing and external use cases such as analysis
pipelines and API integrations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="ionique.utils.Filter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ionique.utils.</span></span><span class="sig-name descname"><span class="pre">Filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lowpass'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'highpass'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bandpass'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bandstop'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'butter'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bessel'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'butter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ionique.utils.Filter" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class allows a user to apply low-pass, high-pass,
band-pass, or band-stop filters using standard filter types (Butterworth or Bessel).
Filters are implemented using second-order sections (SOS) for numerical stability and
can be applied in either forward-only or bidirectional mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff_frequency</strong> (<em>float</em><em> or </em><em>list</em><em>[</em><em>float</em><em>]</em>) – The cutoff frequency or frequency band for the filter in Hz.
For band filters, provide the band center or list of [low, high] values.</p></li>
<li><p><strong>filter_type</strong> (<em>Literal</em><em>[</em><em>&quot;lowpass&quot;</em><em>, </em><em>&quot;highpass&quot;</em><em>, </em><em>&quot;bandpass&quot;</em><em>, </em><em>&quot;bandstop&quot;</em><em>]</em>) – The type of filter to apply. Options are “lowpass”, “highpass”, “bandpass”, or “bandstop”.</p></li>
<li><p><strong>filter_method</strong> (<em>Literal</em><em>[</em><em>&quot;butter&quot;</em><em>, </em><em>&quot;bessel&quot;</em><em>]</em>) – The filter method. Supported options: “butter” (Butterworth), “bessel”. Defaults to “butter”.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – The order of the filter. Must be &gt;= 1. Defaults to 2.</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em>) – If True, applies filtering forward and backward using <cite>sosfiltfilt</cite>.
If False, uses causal <cite>sosfilt</cite>. Defaults to True.</p></li>
<li><p><strong>sampling_frequency</strong> (<em>float</em><em>, </em><em>optional</em>) – Sampling frequency of the signal in Hz.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ionique.utils.Filter.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lowpass'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'highpass'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bandpass'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bandstop'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'butter'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bessel'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'butter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ionique.utils.Filter.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ionique.utils.Filter.bidirectional">
<span class="sig-name descname"><span class="pre">bidirectional</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#ionique.utils.Filter.bidirectional" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ionique.utils.Filter.cutoff_frequency">
<span class="sig-name descname"><span class="pre">cutoff_frequency</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#ionique.utils.Filter.cutoff_frequency" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ionique.utils.Filter.filter_method">
<span class="sig-name descname"><span class="pre">filter_method</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'butter'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bessel'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'butter'</span></em><a class="headerlink" href="#ionique.utils.Filter.filter_method" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ionique.utils.Filter.filter_type">
<span class="sig-name descname"><span class="pre">filter_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lowpass'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'highpass'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bandpass'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bandstop'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ionique.utils.Filter.filter_type" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ionique.utils.Filter.order">
<span class="sig-name descname"><span class="pre">order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#ionique.utils.Filter.order" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ionique.utils.Filter.sampling_frequency">
<span class="sig-name descname"><span class="pre">sampling_frequency</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ionique.utils.Filter.sampling_frequency" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ionique.utils.Singleton">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ionique.utils.</span></span><span class="sig-name descname"><span class="pre">Singleton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ionique.utils.Singleton" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></p>
<p>Generic singleton metaclass.</p>
<p>This metaclass ensures the same return every time the class is instanced.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ionique.utils.Singleton.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ionique.utils.Singleton.__init__" title="Link to this definition"></a></dt>
<dd><p>Class initialization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Arguments for the class</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments for the class</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ionique.utils.Trimmer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ionique.utils.</span></span><span class="sig-name descname"><span class="pre">Trimmer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples_to_remove</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vstep'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newrank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vstepgap'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ionique.utils.Trimmer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Segment trimming utility for hierarchical signal data.</p>
<p>This class operates on a segment tree. It traverses segments of a given rank (e.g., “vstep”) and trims
a fixed number of samples from the start of each segment. The resulting trimmed segments are added
as new child segments with a specified new rank (e.g., “vstepgap”).</p>
<p>This is useful when initial samples of each segment include artifacts that should be excluded from analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples_to_remove</strong> (<em>int</em>) – Number of samples to trim from the beginning of each segment.</p></li>
<li><p><strong>rank</strong> (<em>str</em>) – The hierarchical rank of segments to target for trimming. Defaults to “vstep”.</p></li>
<li><p><strong>newrank</strong> (<em>str</em>) – The rank name to assign to newly created trimmed child segments. Defaults to “vstepgap”.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ionique.utils.Trimmer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples_to_remove</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vstep'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newrank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vstepgap'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ionique.utils.Trimmer.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ionique.utils.Trimmer.newrank">
<span class="sig-name descname"><span class="pre">newrank</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'vstepgap'</span></em><a class="headerlink" href="#ionique.utils.Trimmer.newrank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ionique.utils.Trimmer.rank">
<span class="sig-name descname"><span class="pre">rank</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'vstep'</span></em><a class="headerlink" href="#ionique.utils.Trimmer.rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ionique.utils.Trimmer.samples_to_remove">
<span class="sig-name descname"><span class="pre">samples_to_remove</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ionique.utils.Trimmer.samples_to_remove" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ionique.utils.extract_features">
<span class="sig-prename descclassname"><span class="pre">ionique.utils.</span></span><span class="sig-name descname"><span class="pre">extract_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extractions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_ons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambdas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ionique.utils.extract_features" title="Link to this definition"></a></dt>
<dd><p>Extract features from hierarchical segments into a DataFrame.</p>
<p>Traverses a hierarchical segment structure down to <cite>bottom_rank</cite>, then collects feature values
from each segment. Static features are retrieved via <cite>get_feature()</cite>, constants can be added via
<cite>add_ons</cite>, and custom computed features can be provided through <cite>lambdas</cite>.</p>
<p>This is useful for generating structured datasets from annotated traces for statistical analysis or
machine learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg</strong> (<em>object</em>) – The root segment or trace object containing a hierarchical structure. It must implement <cite>traverse_to_rank()</cite> and support <cite>get_feature()</cite>.</p></li>
<li><p><strong>bottom_rank</strong> (<em>str</em>) – The rank name of the lowest-level segments from which to extract features.</p></li>
<li><p><strong>extractions</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of feature names to extract directly using <cite>get_feature()</cite> on each segment.
Common examples include: ‘mean’, ‘frac’, ‘duration’, ‘baseline’, ‘current’, ‘wrap’, ‘start’.</p></li>
<li><p><strong>add_ons</strong> (<em>dict</em>) – A dictionary of fixed key-value pairs to include as constant columns in the resulting DataFrame.</p></li>
<li><p><strong>lambdas</strong> (<em>dict</em>) – A dictionary mapping column names to lambda functions that compute derived values from each segment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas DataFrame where each row corresponds to a bottom-rank segment and columns represent extracted and computed features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ionique.utils.si_eval">
<span class="sig-prename descclassname"><span class="pre">ionique.utils.</span></span><span class="sig-name descname"><span class="pre">si_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ionique.utils.si_eval" title="Link to this definition"></a></dt>
<dd><p>Evaluate and convert a value with an SI unit prefix to its numeric base value.</p>
<p>This function handles both string-based and numeric values with
SI (International System of Units) prefixes such as “k” (kilo), “M” (mega), “μ” (micro), etc.
It multiplies the input value by the appropriate factor based on the SI prefix.</p>
<p>This utility is useful when parsing human-readable measurement strings or standardizing
units across data pipelines that mix strings and numeric formats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>str</em><em> or </em><em>float</em>) – The value to be converted. Can be a string like “1.2 kHz” or a numeric value (int or float).</p></li>
<li><p><strong>unit</strong> (<em>str</em><em>, </em><em>optional</em>) – The unit string (e.g., “kHz”, “mV”). Required only if <cite>value</cite> is a numeric type.</p></li>
<li><p><strong>return_unit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, returns a tuple containing the converted numeric value and the base unit (e.g., ‘Hz’).
If False, only the numeric value is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the input format is invalid or the unit is missing for numeric input.</p></li>
<li><p><strong>TypeError</strong> – If the value is neither a string nor a numeric type.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The converted value, optionally paired with the base unit.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float or tuple[float, str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ionique.utils.split_voltage_steps">
<span class="sig-prename descclassname"><span class="pre">ionique.utils.</span></span><span class="sig-name descname"><span class="pre">split_voltage_steps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voltage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_tuples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ionique.utils.split_voltage_steps" title="Link to this definition"></a></dt>
<dd><p>Split a voltage signal into segments based on step changes.</p>
<p>This function detects changes in the voltage signal and splits it into individual
segments (or steps) wherever a change in value occurs. It is useful in analyzing
stepwise voltage protocols.</p>
<p>Optionally, a number of initial samples can be removed from each segment using the
<cite>n_remove</cite> parameter. The output can either be two separate arrays of start and end
indices, or a list of tuples representing each segment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voltage</strong> (<em>numpy.ndarray</em>) – 1D voltage signal array to be segmented.</p></li>
<li><p><strong>n_remove</strong> (<em>int</em>) – Number of samples to remove from the start of each split. Defaults to 0.</p></li>
<li><p><strong>as_tuples</strong> (<em>bool</em>) – If True, returns a list of (start, end) index tuples. If False, returns two arrays: start_indices and end_indices. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>n_remove</cite> is negative or larger than the start of the voltage changes.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Either:
- A tuple of (start_indices, end_indices), where each is a numpy array of indices.
- A list of (start, end) tuples if <cite>as_tuples=True</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[numpy.ndarray, numpy.ndarray] or list[tuple[int, int]]</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parsers.html" class="btn btn-neutral float-left" title="ionique.parsers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="datatypes.html" class="btn btn-neutral float-right" title="ionique.datatypes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Ali Fallahi, Dinara Boyko, Wanunu Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>